<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Legal Tool Ultimate</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: var(--tg-theme-bg-color, #ffffff);
            --text-color: var(--tg-theme-text-color, #222222);
            --hint-color: var(--tg-theme-hint-color, #888);
            --secondary-bg: var(--tg-theme-secondary-bg-color, #f0f0f0);
            --accent: var(--tg-theme-button-color, #2481cc);
            --green: #34c759;
            --link-color: #2481cc;
        }
        body {
            background-color: var(--bg-color); color: var(--text-color);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0; display: flex; flex-direction: column; height: 100vh;
            -webkit-tap-highlight-color: transparent;
        }
        /* TABS */
        .tabs {
            display: flex; overflow-x: auto; white-space: nowrap;
            background-color: var(--secondary-bg);
            border-bottom: 1px solid rgba(0,0,0,0.1);
            scrollbar-width: none; padding: 0 5px; flex-shrink: 0;
        }
        .tabs::-webkit-scrollbar { display: none; }
        .tab {
            padding: 14px 16px; text-align: center;
            font-size: 15px; font-weight: 500; color: var(--hint-color);
            border-bottom: 3px solid transparent; flex-shrink: 0;
            cursor: pointer; transition: color 0.2s;
        }
        .tab.active { color: var(--accent); border-bottom: 3px solid var(--accent); }
        
        /* CONTENT & OVERLAY */
        .content { 
            padding: 20px 16px; flex: 1; overflow-y: auto; 
            display: none; position: relative; /* –í–∞–∂–ª–∏–≤–æ –¥–ª—è –æ–≤–µ—Ä–ª–µ—é */
        }
        .content.active { display: block; }

        /* üî• –°–¢–ò–õ–Ü –ë–õ–û–ö–£–í–ê–ù–ù–Ø üî• */
        .locked-overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            z-index: 100;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            text-align: center;
        }
        @media (prefers-color-scheme: dark) {
            .locked-overlay { background: rgba(0, 0, 0, 0.4); }
        }
        .lock-icon { font-size: 40px; margin-bottom: 10px; }
        .lock-title { font-size: 18px; font-weight: 700; margin-bottom: 5px; }
        .lock-desc { font-size: 14px; margin-bottom: 15px; max-width: 80%; opacity: 0.8; }
        .lock-badge {
            background: var(--accent); color: white; padding: 6px 12px;
            border-radius: 8px; font-weight: 600; font-size: 14px;
        }

        /* UI ELEMENTS (–¢–≤—ñ–π –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫–æ–¥) */
        h2 { margin: 0 0 12px 0; font-size: 19px; font-weight: 700; }
        label { font-size: 13px; color: var(--hint-color); margin-bottom: 6px; display: block; font-weight: 500; }
        select, input {
            width: 100%; padding: 12px; border-radius: 12px;
            border: 1px solid var(--hint-color); background-color: var(--secondary-bg);
            color: var(--text-color); font-size: 16px; outline: none; margin-bottom: 16px;
            box-sizing: border-box; -webkit-appearance: none;
        }
        optgroup { color: var(--accent); font-weight: bold; }
        option { color: #000; }
        .row { display: flex; gap: 12px; }
        .col { flex: 1; }
        .result-box {
            background-color: var(--secondary-bg); padding: 16px; border-radius: 14px;
            margin-top: 8px; text-align: center; display: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .price { font-size: 28px; font-weight: 800; color: var(--accent); margin: 5px 0; }
        .price.free { color: var(--green); } 
        .detail-row {
            display: flex; justify-content: space-between; font-size: 14px; margin-top: 8px; 
            border-bottom: 1px dashed rgba(128,128,128, 0.3); padding-bottom: 4px;
        }
        .setting-row {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 12px; background: var(--secondary-bg);
            padding: 12px 16px; border-radius: 12px;
        }
        .setting-label { font-size: 16px; font-weight: 500; }
        .switch { position: relative; display: inline-block; width: 50px; height: 30px; flex-shrink: 0; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #e0e0e0; transition: .3s; border-radius: 34px;
        }
        .slider:before {
            position: absolute; content: ""; height: 26px; width: 26px;
            left: 2px; bottom: 2px; background-color: white; transition: .3s;
            border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        input:checked + .slider { background-color: var(--green); }
        input:checked + .slider:before { transform: translateX(20px); }
        .currency-card {
            display: flex; justify-content: space-between; align-items: center;
            padding: 14px; background: var(--secondary-bg);
            border-radius: 12px; margin-bottom: 10px; font-weight: 500;
        }
        .rate-val { font-weight: 800; color: var(--text-color); font-size: 18px;}
        .flag { font-size: 20px; margin-right: 10px; }
        .btn-calc {
            width: 100%; padding: 14px; background: var(--accent); color: #fff; 
            border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer;
        }
        #loadStatus { font-size:12px; color:var(--hint-color); text-align:center; margin-bottom:10px; }
        .source-link {
            display: block; font-size: 13px; color: var(--link-color); text-decoration: none;
            margin-bottom: 15px; text-align: right;
        }
        .legal-list { margin-top: 10px; }
        .legal-item {
            display: flex; align-items: center; padding: 12px; background: var(--secondary-bg);
            border-radius: 10px; margin-bottom: 8px; text-decoration: none; color: var(--text-color);
        }
        .legal-icon { margin-right: 10px; font-size: 18px; }
        .legal-text { font-size: 14px; font-weight: 500; }
    </style>
</head>
<body>

    <div class="tabs">
        <div class="tab active" onclick="switchTab('court', this)">üèõ –ó–±—ñ—Ä</div>
        <div class="tab" onclick="switchTab('debt', this)">üìâ –ë–æ—Ä–≥–∏</div>
        <div class="tab" onclick="switchTab('vacation', this)">üèñ –í—ñ–¥–ø—É—Å—Ç–∫–∞</div>
        <div class="tab" onclick="switchTab('curr', this)">üí≤ –í–∞–ª—é—Ç–∞</div>
        <div class="tab" onclick="switchTab('info', this)">‚ÑπÔ∏è –Ü–Ω—Ñ–æ</div>
        <div class="tab" onclick="switchTab('dates', this)">üìÖ –°—Ç—Ä–æ–∫–∏</div>
    </div>
    
    <div id="loadStatus">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤...</div>

    <div id="tab-court" class="content active">
        <label>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è –≤–∞—à–æ—ó —Å–ø—Ä–∞–≤–∏:</label>
        <select id="claimType" onchange="calcCourt()">
            <optgroup label="üíµ –ë–æ—Ä–≥–∏, –ì—Ä–æ—à—ñ, –ú–∞–π–Ω–æ">
                <option value="money">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏ –±–æ—Ä–≥ (—Ä–æ–∑–ø–∏—Å–∫–∞, –ø–æ–∑–∏–∫–∞)</option>
                <option value="money">–í—ñ–¥—à–∫–æ–¥—É–≤–∞–Ω–Ω—è –∑–±–∏—Ç–∫—ñ–≤ (–î–¢–ü, –∑–∞–ª–∏—Ç—Ç—è)</option>
                <option value="money">–í–∏–∑–Ω–∞–Ω–Ω—è –ø—Ä–∞–≤–∞ –≤–ª–∞—Å–Ω–æ—Å—Ç—ñ (–ú–∞–π–Ω–æ)</option>
                <option value="inheritance_prop">–°–ø–∞–¥—â–∏–Ω–∞ (–ú–∞–π–Ω–æ–≤–∏–π —Å–ø—ñ—Ä)</option>
            </optgroup>
            <optgroup label="üë®‚Äçüë©‚Äçüëß –°—ñ–º'—è —Ç–∞ –î—ñ—Ç–∏">
                <option value="divorce">–†–æ–∑—ñ—Ä–≤–∞–Ω–Ω—è —à–ª—é–±—É (–†–æ–∑–ª—É—á–µ–Ω–Ω—è)</option>
                <option value="alimony">–ê–ª—ñ–º–µ–Ω—Ç–∏ (–°—Ç—è–≥–Ω–µ–Ω–Ω—è/–ó–º—ñ–Ω–∞)</option>
                <option value="division">–ü–æ–¥—ñ–ª –º–∞–π–Ω–∞ –ø–æ–¥—Ä—É–∂–∂—è</option>
                <option value="paternity">–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –±–∞—Ç—å–∫—ñ–≤—Å—Ç–≤–∞</option>
                <option value="adoption">–£—Å–∏–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∏—Ç–∏–Ω–∏</option>
            </optgroup>
            <optgroup label="üõç –ó–∞—Ö–∏—Å—Ç –ø—Ä–∞–≤ —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤">
                <option value="consumer">–ù–µ—è–∫—ñ—Å–Ω–∏–π —Ç–æ–≤–∞—Ä / –ø–æ—Å–ª—É–≥–∞</option>
                <option value="consumer">–°–ø–æ—Ä–∏ –∑ –ñ–ö–ì (–ö–æ–º—É–Ω–∞–ª–∫–∞)</option>
                <option value="consumer">–°–ø–æ—Ä–∏ –∑ –±–∞–Ω–∫–∞–º–∏ (–ö—Ä–µ–¥–∏—Ç–∏)</option>
            </optgroup>
            <optgroup label="üíº –†–æ–±–æ—Ç–∞ —Ç–∞ –ü–µ–Ω—Å—ñ—ó">
                <option value="labor_salary">–ù–µ–≤–∏–ø–ª–∞—Ç–∞ –∑–∞—Ä–ø–ª–∞—Ç–∏ (–°—Ç—è–≥–Ω–µ–Ω–Ω—è)</option>
                <option value="labor_renew">–ü–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ —Ä–æ–±–æ—Ç—ñ</option>
                <option value="social">–ü–µ–Ω—Å—ñ—ó, –≤–∏–ø–ª–∞—Ç–∏, —Å—É–±—Å–∏–¥—ñ—ó</option>
            </optgroup>
            <optgroup label="üè† –ñ–∏—Ç–ª–æ —Ç–∞ –ó–µ–º–ª—è">
                <option value="housing_evict">–í–∏—Å–µ–ª–µ–Ω–Ω—è / –í–∏–∑–Ω–∞–Ω–Ω—è –≤—Ç—Ä–∞—Ç–∏ –ø—Ä–∞–≤–∞</option>
                <option value="housing_order">–£—Å—É–Ω–µ–Ω–Ω—è –ø–µ—Ä–µ—à–∫–æ–¥ —É –∫–æ—Ä–∏—Å—Ç—É–≤–∞–Ω–Ω—ñ</option>
                <option value="land_non_money">–ó–µ–º–µ–ª—å–Ω—ñ —Å–ø–æ—Ä–∏ (–ú–µ–∂—ñ, –∫–æ—Ä–∏—Å—Ç—É–≤–∞–Ω–Ω—è)</option>
            </optgroup>
            <optgroup label="üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∏ —Ç–∞ –§–∞–∫—Ç–∏">
                <option value="fact">–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ñ–∞–∫—Ç—É (—Å–º–µ—Ä—Ç—ñ, —Ä–æ–¥–∏–Ω–Ω–∏—Ö –∑–≤'—è–∑–∫—ñ–≤)</option>
                <option value="non_money">–í–∏–∑–Ω–∞–Ω–Ω—è –¥–æ–≥–æ–≤–æ—Ä—É –Ω–µ–¥—ñ–π—Å–Ω–∏–º</option>
                <option value="non_money">–Ü–Ω—à–∞ –Ω–µ–º–∞–π–Ω–æ–≤–∞ –≤–∏–º–æ–≥–∞</option>
            </optgroup>
            <optgroup label="‚öñÔ∏è –®—Ç—Ä–∞—Ñ–∏ —Ç–∞ –Ü–Ω—à–µ">
                <option value="traffic">–°–∫–∞—Å—É–≤–∞–Ω–Ω—è —à—Ç—Ä–∞—Ñ—É –ü–î–†</option>
                <option value="admin_fine">–°–∫–∞—Å—É–≤–∞–Ω–Ω—è —ñ–Ω—à–æ–≥–æ –∞–¥–º—ñ–Ω. —à—Ç—Ä–∞—Ñ—É</option>
                <option value="moral">–ú–æ—Ä–∞–ª—å–Ω–∞ —à–∫–æ–¥–∞</option>
            </optgroup>
        </select>
        
        <div id="courtPriceBlock">
            <label>–¶—ñ–Ω–∞ –ø–æ–∑–æ–≤—É (—Å—É–º–∞ —Å—Ç—è–≥–Ω–µ–Ω–Ω—è / –≤–∞—Ä—Ç—ñ—Å—Ç—å –º–∞–π–Ω–∞)</label>
            <input type="number" id="courtPrice" placeholder="–í–≤–µ–¥—ñ—Ç—å —Å—É–º—É..." inputmode="decimal" oninput="calcCourt()">
        </div>
        
        <div class="result-box" id="resCourt">
            <div style="font-size:13px; color:var(--hint-color)">–î–æ —Å–ø–ª–∞—Ç–∏ –≤ –±—é–¥–∂–µ—Ç:</div>
            <div class="price" id="courtTotal">0 –≥—Ä–Ω</div>
            <div style="font-size:13px; color:var(--hint-color); margin-top:5px" id="courtDesc"></div>
        </div>
    </div>

    <div id="tab-debt" class="content">
        <label>–°—É–º–∞ –±–æ—Ä–≥—É</label>
        <input type="number" id="debtSum" placeholder="10000" inputmode="decimal" oninput="calcDebt()">
        <div class="row">
            <div class="col"><label>–ü–æ—á–∞—Ç–æ–∫</label><input type="date" id="dStart" onchange="calcDebt()"></div>
            <div class="col"><label>–ö—ñ–Ω–µ—Ü—å</label><input type="date" id="dEnd" onchange="calcDebt()"></div>
        </div>
        <div class="setting-row">
            <span class="setting-label">3% —Ä—ñ—á–Ω–∏—Ö</span>
            <label class="switch"><input type="checkbox" id="chk3" checked onchange="calcDebt()"><span class="slider"></span></label>
        </div>
        <div class="setting-row">
            <span class="setting-label">–Ü–Ω—Ñ–ª—è—Ü—ñ–π–Ω—ñ</span>
            <label class="switch"><input type="checkbox" id="chkInf" onchange="calcDebt()"><span class="slider"></span></label>
        </div>
        <input type="number" id="infIdx" placeholder="–°—É–∫—É–ø–Ω–∏–π —ñ–Ω–¥–µ–∫—Å (–Ω–∞–ø—Ä. 110.5)" value="100" style="display:none" inputmode="decimal" oninput="calcDebt()">
        <div class="setting-row">
            <span class="setting-label">–ü–µ–Ω—è</span>
            <label class="switch"><input type="checkbox" id="chkPeny" onchange="toggleInput('penyInput', this)"><span class="slider"></span></label>
        </div>
        <div id="penyInput" style="display:none">
            <label>–°—Ç–∞–≤–∫–∞ –ø–µ–Ω—ñ (%)</label>
            <input type="number" id="penyRate" placeholder="25" inputmode="decimal" oninput="calcDebt()">
        </div>
        <div class="result-box" id="resDebt" style="text-align: left;">
            <div class="detail-row"><span>–¢—ñ–ª–æ –±–æ—Ä–≥—É:</span> <span id="outBody" style="font-weight:bold">0</span></div>
            <div class="detail-row"><span>3% —Ä—ñ—á–Ω–∏—Ö:</span> <span id="out3">0</span></div>
            <div class="detail-row"><span>–Ü–Ω—Ñ–ª—è—Ü—ñ–π–Ω—ñ:</span> <span id="outInf">0</span></div>
            <div class="detail-row"><span>–ü–µ–Ω—è:</span> <span id="outPeny">0</span></div>
            <div style="text-align:center; margin-top:15px">
                <span style="font-size:12px; color:var(--hint-color)">–†–ê–ó–û–ú:</span><br>
                <div class="price" id="debtTotal" style="margin-top:0">0 –≥—Ä–Ω</div>
            </div>
        </div>
    </div>

    <div id="tab-vacation" class="content">
        <label>–ü–æ—á–∞—Ç–æ–∫</label>
        <input type="date" id="vacStart" onchange="calcVac()">
        <label>–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å (–¥–Ω—ñ–≤)</label>
        <input type="number" id="vacDays" value="14" inputmode="numeric" oninput="calcVac()">
        <div class="setting-row">
            <div><div class="setting-label">–í–æ—î–Ω–Ω–∏–π —Å—Ç–∞–Ω</div><div style="font-size:11px;color:var(--hint-color)">–í—Å—ñ –¥–Ω—ñ —Ä–æ–±–æ—á—ñ</div></div>
            <label class="switch"><input type="checkbox" id="martialLaw" checked onchange="calcVac()"><span class="slider"></span></label>
        </div>
        <div class="result-box" id="resVac" style="display:block; text-align:left">
            <div class="detail-row"><span>–û—Å—Ç–∞–Ω–Ω—ñ–π –¥–µ–Ω—å:</span> <span id="vacLast" style="font-weight:bold">-</span></div>
            <div class="detail-row"><span>–ù–∞ —Ä–æ–±–æ—Ç—É:</span> <span id="vacReturn" style="font-weight:bold; color:var(--accent)">-</span></div>
        </div>
    </div>

    <div id="tab-curr" class="content">
        <label>–î–∞—Ç–∞ –∫—É—Ä—Å—É</label>
        <input type="date" id="currDate" onchange="fetchRates()">
        <div id="loading" style="text-align:center; display:none; margin: 20px 0; color:var(--hint-color)">‚è≥ –û–Ω–æ–≤–ª–µ–Ω–Ω—è...</div>
        <div id="ratesList" style="margin-bottom:20px"></div>
        <label>–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä</label>
        <div class="row">
            <div class="col" style="flex:2"><input type="number" id="convAmount" placeholder="100" inputmode="decimal" oninput="convert()"></div>
            <div class="col" style="flex:1">
                <select id="convCurr" onchange="convert()">
                    <option value="USD">USD</option>
                    <option value="EUR">EUR</option>
                </select>
            </div>
        </div>
        <div class="result-box" id="resConv" style="display:block; padding:10px;">
            <div class="price" id="convResult">0.00 UAH</div>
        </div>
    </div>

    <div id="tab-info" class="content">
        <h2 id="stdYear">üìä –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏</h2>
        <a id="linkBudget" href="#" target="_blank" class="source-link" style="display:none">üìú –ó–∞–∫–æ–Ω –ø—Ä–æ –ë—é–¥–∂–µ—Ç üîó</a>
        <div class="currency-card">
            <div>üí∞ –ú—ñ–Ω. –∑–∞—Ä–ø–ª–∞—Ç–∞ (–ú–ó–ü)</div><div class="rate-val" id="valMinWage">...</div>
        </div>
        <div class="currency-card">
            <div>üßë –ü—Ä–æ–∂–∏—Ç–∫–æ–≤–∏–π (–ü—Ä–∞—Ü–µ–∑–¥–∞—Ç–Ω—ñ)</div><div class="rate-val" id="valPmAble">...</div>
        </div>
        <details style="margin-bottom:15px; background:var(--secondary-bg); padding:10px; border-radius:12px;">
            <summary style="font-weight:500; cursor:pointer;">–Ü–Ω—à—ñ –ø—Ä–æ–∂–∏—Ç–∫–æ–≤—ñ –º—ñ–Ω—ñ–º—É–º–∏</summary>
            <div style="margin-top:10px; font-size:14px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                    <span>üë∂ –î—ñ—Ç–∏ –¥–æ 6 —Ä–æ–∫—ñ–≤:</span> <b id="valPm6">...</b>
                </div>
                <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                    <span>üßí –î—ñ—Ç–∏ 6-18 —Ä–æ–∫—ñ–≤:</span> <b id="valPm18">...</b>
                </div>
                <div style="display:flex; justify-content:space-between;">
                    <span>üë¥ –ù–µ–ø—Ä–∞—Ü–µ–∑–¥–∞—Ç–Ω—ñ:</span> <b id="valPmDisable">...</b>
                </div>
            </div>
        </details>
        <h2>üíº –§–û–ü (–°–ø—Ä–æ—â–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞)</h2>
        <div class="result-box" style="display:block; text-align:left; margin-top:0;">
            <div style="font-size:12px; color:var(--hint-color); margin-bottom:10px; text-align:center">–°—Ç–∞–≤–∫–∏ –ø–æ–¥–∞—Ç–∫—ñ–≤ (–º—ñ—Å—è—Ü—å)</div>
            <div class="detail-row"><span>–Ñ–°–í (22%):</span> <span id="taxESV" style="font-weight:bold">...</span></div>
            <div class="detail-row"><span>–Ñ–ü (1 –≥—Ä—É–ø–∞, 10% –ü–ú):</span> <span id="taxEP1" style="font-weight:bold">...</span></div>
            <div class="detail-row"><span>–Ñ–ü (2 –≥—Ä—É–ø–∞, 20% –ú–ó–ü):</span> <span id="taxEP2" style="font-weight:bold">...</span></div>
        </div>
        <div class="result-box" style="display:block; text-align:left;">
            <div style="font-size:12px; color:var(--hint-color); margin-bottom:10px; text-align:center">–†—ñ—á–Ω—ñ –ª—ñ–º—ñ—Ç–∏ –¥–æ—Ö–æ–¥—É</div>
            <div class="detail-row"><span>1 –≥—Ä—É–ø–∞ (167 –ú–ó–ü):</span> <span id="limFop1" style="font-weight:bold">...</span></div>
            <div class="detail-row"><span>2 –≥—Ä—É–ø–∞ (834 –ú–ó–ü):</span> <span id="limFop2" style="font-weight:bold">...</span></div>
            <div class="detail-row"><span>3 –≥—Ä—É–ø–∞ (1167 –ú–ó–ü):</span> <span id="limFop3" style="font-weight:bold">...</span></div>
        </div>
        <h2 style="margin-top:20px">üë∂ –ê–ª—ñ–º–µ–Ω—Ç–∏</h2>
        <label>–î–æ—Ö—ñ–¥ –ø–ª–∞—Ç–Ω–∏–∫–∞ (–≥—Ä–Ω)</label>
        <input type="number" id="alimIncome" placeholder="15000" inputmode="decimal" oninput="calcAlim()">
        <div class="row">
            <div class="col"><label>–î—ñ—Ç–∏ –¥–æ 6 —Ä–æ–∫—ñ–≤</label><input type="number" id="cntChild6" placeholder="0" inputmode="numeric" oninput="calcAlim()"></div>
            <div class="col"><label>–î—ñ—Ç–∏ 6-18 —Ä–æ–∫—ñ–≤</label><input type="number" id="cntChild18" placeholder="0" inputmode="numeric" oninput="calcAlim()"></div>
        </div>
        <div class="result-box" id="resAlim" style="display:block; text-align:left">
            <div class="detail-row"><span>–ß–∞—Å—Ç–∫–∞ –≤—ñ–¥ –¥–æ—Ö–æ–¥—É:</span> <span id="alimShare" style="font-weight:bold">0.00 –≥—Ä–Ω</span></div>
            <div class="detail-row"><span>–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –≥–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–∏–π*:</span> <span id="alimMin" style="font-weight:bold; color:var(--hint-color)">0.00 –≥—Ä–Ω</span></div>
            <div id="alimAlert" style="font-size:12px; color:red; margin-top:5px; display:none">‚ö†Ô∏è –°—É–º–∞ –º–µ–Ω—à–∞ –∑–∞ –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π –º—ñ–Ω—ñ–º—É–º!</div>
            <div style="font-size:11px; color:var(--hint-color); margin-top:5px">*–°—É–º–∞ 50% –ø—Ä–æ–∂–∏—Ç–∫–æ–≤–∏—Ö –º—ñ–Ω—ñ–º—É–º—ñ–≤ –¥–ª—è –¥—ñ—Ç–µ–π –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ –≤—ñ–∫—É.</div>
        </div>
        <h2 style="margin-top:25px">üìö –ù–æ—Ä–º–∞—Ç–∏–≤–Ω–∞ –±–∞–∑–∞</h2>
        <div class="legal-list">
            <a id="linkCourt" href="#" target="_blank" class="legal-item" style="display:none"><span class="legal-icon">‚öñÔ∏è</span> <span class="legal-text" id="txtCourt">–ó–∞–∫–æ–Ω –ø—Ä–æ —Å—É–¥–æ–≤–∏–π –∑–±—ñ—Ä</span></a>
            <a id="linkCC" href="#" target="_blank" class="legal-item" style="display:none"><span class="legal-icon">üìú</span> <span class="legal-text" id="txtCC">–¶–ö –£–∫—Ä–∞—ó–Ω–∏ (—Å—Ç. 625)</span></a>
            <a id="linkFamily" href="#" target="_blank" class="legal-item" style="display:none"><span class="legal-icon">üë®‚Äçüë©‚Äçüëß</span> <span class="legal-text" id="txtFamily">–°—ñ–º–µ–π–Ω–∏–π –∫–æ–¥–µ–∫—Å (–ê–ª—ñ–º–µ–Ω—Ç–∏)</span></a>
            <a id="linkPod" href="#" target="_blank" class="legal-item" style="display:none"><span class="legal-icon">üí∞</span> <span class="legal-text" id="txtPod">–ü–æ–¥–∞—Ç–∫–æ–≤–∏–π –∫–æ–¥–µ–∫—Å (–õ—ñ–º—ñ—Ç–∏ –§–û–ü)</span></a>
        </div>
    </div>

    <div id="tab-dates" class="content">
        <label>–ü–æ—á–∞—Ç–∫–æ–≤–∞ –¥–∞—Ç–∞</label>
        <input type="date" id="dateCalc1">
        <div class="row">
            <div class="col" style="flex:1">
                <label>–î—ñ—è</label>
                <select id="dateOp">
                    <option value="1">‚ûï –î–æ–¥–∞—Ç–∏</option>
                    <option value="-1">‚ûñ –í—ñ–¥–Ω—è—Ç–∏</option>
                </select>
            </div>
            <div class="col" style="flex:2">
                <label>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤</label>
                <input type="number" id="dateCalcDays" placeholder="10" inputmode="numeric">
            </div>
        </div>
        <button class="btn-calc" onclick="calcDateSimple()">–†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
        <div class="result-box" id="resDateSimple">
            <div style="font-size:13px; color:var(--hint-color)">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div>
            <div class="price" id="dateSimpleRes">-</div>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp; 
        tg.ready(); tg.expand();
        const mainButton = tg.MainButton;
        
        // --- –õ–û–ì–Ü–ö–ê –î–û–°–¢–£–ü–£ (–ù–û–í–ê –ß–ê–°–¢–ò–ù–ê) ---
        const urlParams = new URLSearchParams(window.location.search);
        const userSub = urlParams.get('sub') || 'free'; 
        
        const SUB_LEVELS = { 'free': 0, 'lite': 1, 'pro': 2, 'admin': 3 };
        const myLevel = SUB_LEVELS[userSub] || 0;
        const REQ_NAMES = { 1: "Lite", 2: "Pro" };

        const TAB_REQ = {
            'court': 1,    // Lite+
            'debt': 2,     // Pro+
            'vacation': 2, // Pro+
            'curr': 2,     // Pro+
            'dates': 2,    // Pro+
            'info': 0      // Free (–í—Å—ñ)
        };

        function checkAccess(tabId, contentEl) {
            let old = contentEl.querySelector('.locked-overlay');
            if(old) old.remove();

            const reqLevel = TAB_REQ[tabId];
            if (myLevel < reqLevel) {
                const requiredName = REQ_NAMES[reqLevel];
                let overlay = document.createElement('div');
                overlay.className = 'locked-overlay';
                overlay.innerHTML = `
                    <div class="lock-icon">üîí</div>
                    <div class="lock-title">–î–æ—Å—Ç—É–ø –∑–∞–∫—Ä–∏—Ç–æ</div>
                    <div class="lock-desc">–¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π —É —Ç–∞—Ä–∏—Ñ—ñ <b>${requiredName}</b></div>
                    <div class="lock-badge">–ü–æ—Ç—Ä—ñ–±–Ω–∞ –ø—ñ–¥–ø–∏—Å–∫–∞</div>
                `;
                contentEl.appendChild(overlay);
                return false; 
            }
            return true; 
        }

        // --- TABS (–û–ù–û–í–õ–ï–ù–û) ---
        function switchTab(id, elem) {
            document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.content').forEach(el => el.classList.remove('active'));
            
            let contentDiv = document.getElementById('tab-'+id);
            document.getElementById('tab-'+id).classList.add('active');
            elem.classList.add('active');

            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –¥–æ—Å—Ç—É–ø
            checkAccess(id, contentDiv);

            if(id === 'curr') fetchRates();
        }

        // --- –î–ò–ù–ê–ú–Ü–ß–ù–Ü –ó–ú–Ü–ù–ù–Ü (–ë–ï–ó –ó–ú–Ü–ù) ---
        let STD = { year: 2026, min_wage: 8000, pm_able: 3200, pm_child_6: 2563, pm_child_18: 3196, pm_disable: 2361 };
        
        // –†–µ—à—Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–π (calcCourt, calcDebt, loadStandards...) –¢–£–¢ –ó–ê–õ–ò–®–ê–Æ–¢–¨–°–Ø –Ø–ö –ë–£–õ–ò
        // –©–æ–± –Ω–µ –¥—É–±–ª—é–≤–∞—Ç–∏ 300 —Ä—è–¥–∫—ñ–≤ –∫–æ–¥—É, —Å–∫–æ–ø—ñ—é–π —ó—Ö –∑—ñ —Å–≤–æ–≥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ —Ñ–∞–π–ª—É index.html.
        // –Ø –¥–æ–¥–∞–≤ –ª–∏—à–µ switchTab, checkAccess —Ç–∞ —Å—Ç–∏–ª—ñ.
        
        async function loadStandards() {
            try {
                let response = await fetch('standards.json');
                if (response.ok) {
                    let data = await response.json();
                    STD = data; 
                    document.getElementById("loadStatus").innerText = `–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏ –Ω–∞ ${STD.year} —Ä—ñ–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ ‚úÖ`;
                    updateInfoTab(data);
                    // –ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –∞–∫—Ç–∏–≤–Ω–æ—ó –≤–∫–ª–∞–¥–∫–∏
                    let activeTab = document.querySelector('.content.active').id;
                    if(activeTab === 'tab-court') calcCourt();
                    if(activeTab === 'tab-info') calcAlim();
                } else {
                    document.getElementById("loadStatus").innerText = "–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –∫–µ—à)";
                    updateInfoTab(STD);
                }
            } catch (e) {
                console.log("JSON load error", e);
                document.getElementById("loadStatus").innerText = "–û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è)";
                updateInfoTab(STD);
            }
        }
        
        function updateInfoTab(data) {
            document.getElementById("stdYear").innerText = `üìä –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏ ${STD.year}`;
            document.getElementById("valMinWage").innerText = `${STD.min_wage} –≥—Ä–Ω`;
            document.getElementById("valPmAble").innerText = `${STD.pm_able} –≥—Ä–Ω`;
            document.getElementById("valPm6").innerText = `${STD.pm_child_6} –≥—Ä–Ω`;
            document.getElementById("valPm18").innerText = `${STD.pm_child_18} –≥—Ä–Ω`;
            document.getElementById("valPmDisable").innerText = `${STD.pm_disable} –≥—Ä–Ω`;
            let esv = STD.min_wage * 0.22;
            let ep1 = STD.pm_able * 0.1;
            let ep2 = STD.min_wage * 0.2;
            document.getElementById("taxESV").innerText = `${esv.toFixed(2)} –≥—Ä–Ω`;
            document.getElementById("taxEP1").innerText = `${ep1.toFixed(2)} –≥—Ä–Ω`;
            document.getElementById("taxEP2").innerText = `${ep2.toFixed(2)} –≥—Ä–Ω`;
            const fmt = num => num.toLocaleString('uk-UA').replace(/,/g, " ");
            document.getElementById("limFop1").innerText = `${fmt(STD.min_wage * 167)} –≥—Ä–Ω`;
            document.getElementById("limFop2").innerText = `${fmt(STD.min_wage * 834)} –≥—Ä–Ω`;
            document.getElementById("limFop3").innerText = `${fmt(STD.min_wage * 1167)} –≥—Ä–Ω`;
            if(data.budget_law_url) { let lnk = document.getElementById("linkBudget"); lnk.href = data.budget_law_url; lnk.innerText = `üìú ${data.budget_law_name || "–ó–∞–∫–æ–Ω –ø—Ä–æ –ë—é–¥–∂–µ—Ç"} üîó`; lnk.style.display = "block"; }
            if(data.court_fee_law_url) { let lnk = document.getElementById("linkCourt"); lnk.href = data.court_fee_law_url; document.getElementById("txtCourt").innerText = data.court_fee_law_name || "–ó–∞–∫–æ–Ω –ø—Ä–æ —Å—É–¥–æ–≤–∏–π –∑–±—ñ—Ä"; lnk.style.display = "flex"; }
            if(data.cc_law_url) { let lnk = document.getElementById("linkCC"); lnk.href = data.cc_law_url; document.getElementById("txtCC").innerText = data.cc_law_name || "–¶–ö –£–∫—Ä–∞—ó–Ω–∏ (—Å—Ç. 625)"; lnk.style.display = "flex"; }
            if(data.family_law_url) { let lnk = document.getElementById("linkFamily"); lnk.href = data.family_law_url; document.getElementById("txtFamily").innerText = data.family_law_name || "–°—ñ–º–µ–π–Ω–∏–π –∫–æ–¥–µ–∫—Å"; lnk.style.display = "flex"; }
            if(data.tax_code_url) { let lnk = document.getElementById("linkPod"); lnk.href = data.tax_code_url; document.getElementById("txtPod").innerText = data.tax_code_name || "–ü–æ–¥–∞—Ç–∫–æ–≤–∏–π –∫–æ–¥–µ–∫—Å"; lnk.style.display = "flex"; }
        }

        let currentClickCallback = null;
        function sendBtn(data) {
            mainButton.setText("–í–Ü–î–ü–†–ê–í–ò–¢–ò –í –ß–ê–¢"); mainButton.show();
            if (currentClickCallback) mainButton.offClick(currentClickCallback);
            currentClickCallback = function() { tg.sendData(JSON.stringify(data)); };
            mainButton.onClick(currentClickCallback);
        }

        // Court Fee
        function calcCourt() {
            let PM = STD.pm_able; let type = document.getElementById("claimType").value; let price = parseFloat(document.getElementById("courtPrice").value); let fee = 0; let desc = ""; let isFree = false; let typeText = document.getElementById("claimType").options[document.getElementById("claimType").selectedIndex].text;
            let needsPrice = ["money", "division", "moral", "inheritance_prop"].includes(type); document.getElementById("courtPriceBlock").style.display = needsPrice ? "block" : "none";
            switch(type) {
                case "money": case "inheritance_prop": if(price > 0) { fee = Math.max(PM * 0.4, Math.min(price * 0.01, PM * 5)); desc = "1% (–º—ñ–Ω. 0.4 –ü–ú)"; } break;
                case "division": if(price > 0) { fee = Math.max(PM * 0.4, Math.min(price * 0.01, PM * 3)); desc = "1% (–º–∞–∫—Å. 3 –ü–ú)"; } break;
                case "divorce": fee = PM * 0.4; desc = "0.4 –ü–ú"; break;
                case "alimony": isFree = true; desc = "–ó–≤—ñ–ª—å–Ω–µ–Ω–æ"; break;
                case "paternity": fee = PM * 0.4; desc = "0.4 –ü–ú"; break;
                case "adoption": fee = PM * 0.2; desc = "0.2 –ü–ú"; break;
                case "consumer": isFree = true; desc = "–ó–≤—ñ–ª—å–Ω–µ–Ω–æ"; break;
                case "labor_salary": case "labor_renew": isFree = true; desc = "–ó–≤—ñ–ª—å–Ω–µ–Ω–æ"; break;
                case "social": fee = PM * 0.4; desc = "–ü—ñ–ª—å–≥–∏"; break;
                case "housing_evict": case "housing_order": case "land_non_money": case "non_money": fee = PM * 0.4; desc = "0.4 –ü–ú"; break;
                case "fact": case "traffic": case "admin_fine": fee = PM * 0.2; desc = "0.2 –ü–ú"; break;
                case "moral": if(price > 0) { if(price <= PM*5) { fee = PM * 0.4; desc = "0.4 –ü–ú"; } else { fee = Math.max(PM, price * 0.015); desc = "1.5% (–º—ñ–Ω 1 –ü–ú)"; } } break;
            }
            let resEl = document.getElementById("courtTotal"); if (isFree) { resEl.innerText = "0 –≥—Ä–Ω ‚úÖ"; resEl.classList.add("free"); } else { resEl.innerText = fee.toFixed(2) + " –≥—Ä–Ω"; resEl.classList.remove("free"); }
            document.getElementById("courtDesc").innerText = desc; document.getElementById("resCourt").style.display = "block";
            sendBtn({type:"tool_court_fee", fee: isFree ? "0.00" : fee.toFixed(2), desc: typeText});
        }

        // Debt
        function toggleInput(id, cb) { document.getElementById(id).style.display = cb.checked ? "block" : "none"; calcDebt(); }
        function calcDebt() {
            let s = parseFloat(document.getElementById("debtSum").value); let d1 = new Date(document.getElementById("dStart").value); let d2 = new Date(document.getElementById("dEnd").value);
            document.getElementById("infIdx").style.display = document.getElementById("chkInf").checked ? "block" : "none";
            if(!s || isNaN(d1) || isNaN(d2)) return;
            let days = Math.ceil((d2 - d1) / (86400000)); if(days < 0) days = 0;
            let p3 = document.getElementById("chk3").checked ? s * 0.03 * (days/365) : 0;
            let idx = parseFloat(document.getElementById("infIdx").value);
            let inf = (document.getElementById("chkInf").checked && idx > 100) ? s*(idx/100)-s : 0;
            let rate = parseFloat(document.getElementById("penyRate").value);
            let peny = (document.getElementById("chkPeny").checked && rate) ? s*(rate/100)*(days/365) : 0;
            let total = s + p3 + inf + peny;
            document.getElementById("outBody").innerText = s.toFixed(2); document.getElementById("out3").innerText = p3.toFixed(2);
            document.getElementById("outInf").innerText = inf.toFixed(2); document.getElementById("outPeny").innerText = peny.toFixed(2);
            document.getElementById("debtTotal").innerText = total.toFixed(2) + " –≥—Ä–Ω"; document.getElementById("resDebt").style.display = "block";
            sendBtn({type:"tool_debt_calc", total:total.toFixed(2), details: `–¢—ñ–ª–æ: ${s.toFixed(2)}\n3%: ${p3.toFixed(2)}\n–Ü–Ω—Ñ–ª: ${inf.toFixed(2)}\n–ü–µ–Ω—è: ${peny.toFixed(2)}`});
        }

        // Vacation
        function getEasterDate(year) { let a = year%19, b=year%4, c=year%7, d=(19*a+15)%30, e=(2*b+4*c+6*d+6)%7, f=d+e; let day = (f+4>30)?(f+4-30):(f+4), month = (f+4>30)?4:3; return new Date(year, month, day); }
        function getHolidays(year) { let h = [`${year}-01-01`,`${year}-03-08`,`${year}-05-01`,`${year}-05-08`,`${year}-06-28`,`${year}-07-15`,`${year}-08-24`,`${year}-10-01`,`${year}-12-25`]; let easter = getEasterDate(year); const fmt = d => d.toISOString().split('T')[0]; h.push(fmt(easter)); let trinity = new Date(easter); trinity.setDate(easter.getDate()+49); h.push(fmt(trinity)); return h; }
        function calcVac() {
            let startVal = document.getElementById("vacStart").value; let days = parseInt(document.getElementById("vacDays").value); let isMartial = document.getElementById("martialLaw").checked;
            if(!startVal || !days) return;
            let current = new Date(startVal); let added = 0; let holidaySet = new Set();
            if(!isMartial) { let y = current.getFullYear(); getHolidays(y).forEach(d => holidaySet.add(d)); getHolidays(y+1).forEach(d => holidaySet.add(d)); }
            while(added < days) { let dateStr = current.toISOString().split('T')[0]; if(!isMartial && holidaySet.has(dateStr)) {} else { added++; } if(added < days) current.setDate(current.getDate() + 1); }
            document.getElementById("vacLast").innerText = current.toLocaleDateString('uk-UA');
            let ret = new Date(current); ret.setDate(ret.getDate()+1); while(ret.getDay()===0 || ret.getDay()===6) ret.setDate(ret.getDate()+1);
            document.getElementById("vacReturn").innerText = ret.toLocaleDateString('uk-UA');
            sendBtn({type:"tool_vacation_calc", returnDate: document.getElementById("vacReturn").innerText});
        }

        // Alimony
        function calcAlim() {
            let income = parseFloat(document.getElementById("alimIncome").value) || 0; let c6 = parseInt(document.getElementById("cntChild6").value) || 0; let c18 = parseInt(document.getElementById("cntChild18").value) || 0; let totalKids = c6 + c18;
            let share = 0; let shareText = "0%";
            if (totalKids === 1) { share = 0.25; shareText = "1/4 (25%)"; } else if (totalKids === 2) { share = 0.3333; shareText = "1/3 (33%)"; } else if (totalKids >= 3) { share = 0.5; shareText = "1/2 (50%)"; }
            let shareSum = income * share;
            let min6 = STD.pm_child_6 * 0.5; let min18 = STD.pm_child_18 * 0.5; let totalMin = (c6 * min6) + (c18 * min18);
            let shareEl = document.getElementById("alimShare"); let alertBox = document.getElementById("alimAlert");
            shareEl.innerText = `${shareSum.toFixed(2)} –≥—Ä–Ω (${shareText})`; document.getElementById("alimMin").innerText = `${totalMin.toFixed(2)} –≥—Ä–Ω`;
            if (income > 0 && shareSum < totalMin) { shareEl.style.color = "red"; alertBox.style.display = "block"; } else { shareEl.style.color = "var(--text-color)"; alertBox.style.display = "none"; }
            if (income > 0 || totalKids > 0) { sendBtn({ type: "tool_alim_calc", total: shareSum.toFixed(2), min: totalMin.toFixed(2), kids: totalKids, details: `–î–æ 6 —Ä: ${c6}, 6-18 —Ä: ${c18}` }); }
        }

        // Currency
        let ratesCache = {};
        async function fetchRates() {
            let dateVal = document.getElementById("currDate").value; let url = `https://bank.gov.ua/NBUStatService/v1/statdirectory/exchange?date=${dateVal.replaceAll('-','')}&json`;
            document.getElementById("loading").style.display = "block"; document.getElementById("ratesList").innerHTML = "";
            try { let resp = await fetch(url); let data = await resp.json(); document.getElementById("loading").style.display = "none"; let usd = data.find(r => r.cc === "USD"); let eur = data.find(r => r.cc === "EUR"); ratesCache = { USD: usd?.rate, EUR: eur?.rate }; let html = ""; if(usd) html += `<div class="currency-card"><div><span class="flag">üá∫üá∏</span>USD</div><div class="rate-val">${usd.rate.toFixed(4)}</div></div>`; if(eur) html += `<div class="currency-card"><div><span class="flag">üá™üá∫</span>EUR</div><div class="rate-val">${eur.rate.toFixed(4)}</div></div>`; document.getElementById("ratesList").innerHTML = html; convert(); } catch(e) { document.getElementById("ratesList").innerHTML = "–ü–æ–º–∏–ª–∫–∞ –ù–ë–£"; document.getElementById("loading").style.display="none"; }
        }
        function convert() { let amt = parseFloat(document.getElementById("convAmount").value); let curr = document.getElementById("convCurr").value; if(amt && ratesCache[curr]) document.getElementById("convResult").innerText = (amt * ratesCache[curr]).toFixed(2) + " UAH"; }

        // Dates
        function calcDateSimple() {
            let d = new Date(document.getElementById("dateCalc1").value); let days = parseInt(document.getElementById("dateCalcDays").value); let op = parseInt(document.getElementById("dateOp").value);
            if(!isNaN(d.getTime()) && days) { d.setDate(d.getDate() + (days * op)); document.getElementById("dateSimpleRes").innerText = d.toLocaleDateString('uk-UA'); document.getElementById("resDateSimple").style.display = "block"; }
        }

        // Init
        let today = new Date().toISOString().split('T')[0];
        document.getElementById('currDate').value = today; document.getElementById('dStart').value = today; document.getElementById('dEnd').value = today; document.getElementById('vacStart').value = today; document.getElementById('dateCalc1').value = today;
        
        loadStandards();
        
        // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –ø–µ—Ä—à—É –≤–∫–ª–∞–¥–∫—É –Ω–∞ —Å—Ç–∞—Ä—Ç—ñ
        window.onload = function() {
             switchTab('court', document.querySelector('.tab'));
        };
    </script>
</body>
</html>